{"ast":null,"code":"import _slicedToArray from\"/Users/gus/Documents/work_in_progress/gusbook/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from\"react\";import{useSelector,useDispatch}from\"react-redux\";import{updatePost}from\"../../actions/post.actions\";import{isEmpty,dateParser}from\"../../Util/functions\";import FollowHandler from\"../profil/FollowHandler\";import CardComments from\"./CardComments\";import DeleteCard from\"./DeleteCard\";import LikeButton from\"./LikeButton\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var Card=function Card(_ref){var post=_ref.post;var _useState=useState(true),_useState2=_slicedToArray(_useState,2),isLoading=_useState2[0],setIsLoading=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),isUpdated=_useState4[0],setIsUpdated=_useState4[1];var _useState5=useState(null),_useState6=_slicedToArray(_useState5,2),textUpdate=_useState6[0],setTextUpdate=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),showComments=_useState8[0],setShowComments=_useState8[1];var usersData=useSelector(function(state){return state.usersReducer;});var userData=useSelector(function(state){return state.userReducer;});var dispatch=useDispatch();var updateItem=function updateItem(){if(textUpdate){dispatch(updatePost(post._id,textUpdate));}setIsUpdated(false);};useEffect(function(){!isEmpty(usersData[0])&&setIsLoading(false);},[usersData,isUpdated]);return/*#__PURE__*/_jsx(\"li\",{className:\"card-container\",children:isLoading?/*#__PURE__*/_jsx(\"i\",{className:\"fas fa-spinner fa-spin\"}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"div\",{className:\"card-left\",children:/*#__PURE__*/_jsx(\"img\",{src:!isEmpty(usersData[0])&&usersData.map(function(user){if(user._id===post.posterId)return user.picture;else return null;}).join(\"\"),alt:\"poster-pic\"})}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-right\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"card-header\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"pseudo\",children:[/*#__PURE__*/_jsx(\"h3\",{children:!isEmpty(usersData[0])&&usersData.map(function(user){if(user._id===post.posterId)return user.pseudo;else return null;})}),post.posterId!==userData._id&&/*#__PURE__*/_jsx(FollowHandler,{type:\"card\",idToFollow:post.posterId})]}),/*#__PURE__*/_jsx(\"span\",{children:dateParser(post.createdAt)})]}),isUpdated===false&&/*#__PURE__*/_jsx(\"p\",{children:post.message}),isUpdated&&/*#__PURE__*/_jsxs(\"div\",{className:\"update-post\",children:[/*#__PURE__*/_jsx(\"textarea\",{defaultValue:post.message,onChange:function onChange(event){return setTextUpdate(event.target.value);}}),/*#__PURE__*/_jsx(\"div\",{className:\"button-container\",children:/*#__PURE__*/_jsx(\"button\",{className:\"btn\",onClick:updateItem,children:\"Valider les modifications\"})})]}),post.picture&&/*#__PURE__*/_jsx(\"img\",{src:post.picture,alt:\"card-pic\",className:\"card-pic\"}),post.video&&/*#__PURE__*/_jsx(\"iframe\",{width:\"500\",height:\"300\",src:post.video,frameBorder:\"0\",allow:\"accelerometer ; autoplay; clipboard-write ; encrypted-media; gyroscope; picture-in-picture\",allowFullScreen:true,title:post._id}),userData._id===post.posterId&&/*#__PURE__*/_jsxs(\"div\",{className:\"button-container\",children:[/*#__PURE__*/_jsx(\"div\",{onClick:function onClick(){return setIsUpdated(!isUpdated);},children:/*#__PURE__*/_jsx(\"img\",{src:\"./img/icons/edit.svg\",alt:\"edit\"})}),/*#__PURE__*/_jsx(DeleteCard,{postId:post._id})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"card-footer\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"comment-icon\",children:[/*#__PURE__*/_jsx(\"img\",{onClick:function onClick(){return setShowComments(!showComments);},src:\"./img/icons/message1.svg\",alt:\"messageicon\"}),/*#__PURE__*/_jsx(\"span\",{children:post.comments.length})]}),/*#__PURE__*/_jsx(LikeButton,{post:post}),/*#__PURE__*/_jsx(\"img\",{src:\"./img/icons/share.svg\",alt:\"shareicon\"})]}),showComments&&/*#__PURE__*/_jsx(CardComments,{post:post})]})]})},post._id);};export default Card;","map":{"version":3,"sources":["/Users/gus/Documents/work_in_progress/gusbook/client/src/components/Post/Card.js"],"names":["React","useState","useEffect","useSelector","useDispatch","updatePost","isEmpty","dateParser","FollowHandler","CardComments","DeleteCard","LikeButton","Card","post","isLoading","setIsLoading","isUpdated","setIsUpdated","textUpdate","setTextUpdate","showComments","setShowComments","usersData","state","usersReducer","userData","userReducer","dispatch","updateItem","_id","map","user","posterId","picture","join","pseudo","createdAt","message","event","target","value","video","comments","length"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { updatePost } from \"../../actions/post.actions\";\nimport { isEmpty, dateParser } from \"../../Util/functions\";\nimport FollowHandler from \"../profil/FollowHandler\";\nimport CardComments from \"./CardComments\";\nimport DeleteCard from \"./DeleteCard\";\nimport LikeButton from \"./LikeButton\";\n\nconst Card = ({ post }) => {\n  const [isLoading, setIsLoading] = useState(true);\n  const [isUpdated, setIsUpdated] = useState(false);\n  const [textUpdate, setTextUpdate] = useState(null);\n  const [showComments, setShowComments] = useState(false);\n\n  const usersData = useSelector((state) => state.usersReducer);\n  const userData = useSelector((state) => state.userReducer);\n  const dispatch = useDispatch();\n\n  const updateItem = () => {\n    if (textUpdate) {\n      dispatch(updatePost(post._id, textUpdate));\n    }\n    setIsUpdated(false);\n  };\n\n  useEffect(() => {\n    !isEmpty(usersData[0]) && setIsLoading(false);\n  }, [usersData, isUpdated]);\n\n  return (\n    <li className=\"card-container\" key={post._id}>\n      {isLoading ? (\n        <i className=\"fas fa-spinner fa-spin\"></i>\n      ) : (\n        <>\n          <div className=\"card-left\">\n            <img\n              src={\n                !isEmpty(usersData[0]) &&\n                usersData\n                  .map((user) => {\n                    if (user._id === post.posterId) return user.picture;\n                    else return null;\n                  })\n                  .join(\"\")\n              }\n              alt=\"poster-pic\"\n            />\n          </div>\n          <div className=\"card-right\">\n            <div className=\"card-header\">\n              <div className=\"pseudo\">\n                <h3>\n                  {!isEmpty(usersData[0]) &&\n                    usersData.map((user) => {\n                      if (user._id === post.posterId) return user.pseudo;\n                      else return null;\n                    })}\n                </h3>\n                {post.posterId !== userData._id && (\n                  <FollowHandler type=\"card\" idToFollow={post.posterId} />\n                )}\n              </div>\n              <span>{dateParser(post.createdAt)}</span>\n            </div>\n            {isUpdated === false && <p>{post.message}</p>}\n            {isUpdated && (\n              <div className=\"update-post\">\n                <textarea\n                  defaultValue={post.message}\n                  onChange={(event) => setTextUpdate(event.target.value)}\n                />\n                <div className=\"button-container\">\n                  <button className=\"btn\" onClick={updateItem}>\n                    Valider les modifications\n                  </button>\n                </div>\n              </div>\n            )}\n            {post.picture && (\n              <img src={post.picture} alt=\"card-pic\" className=\"card-pic\" />\n            )}\n            {post.video && (\n              <iframe\n                width=\"500\"\n                height=\"300\"\n                src={post.video}\n                frameBorder=\"0\"\n                allow=\"accelerometer ; autoplay; clipboard-write ; encrypted-media; gyroscope; picture-in-picture\"\n                allowFullScreen\n                title={post._id}\n              ></iframe>\n            )}\n            {userData._id === post.posterId && (\n              <div className=\"button-container\">\n                <div onClick={() => setIsUpdated(!isUpdated)}>\n                  <img src=\"./img/icons/edit.svg\" alt=\"edit\" />\n                </div>\n                <DeleteCard postId={post._id} />\n              </div>\n            )}\n            <div className=\"card-footer\">\n              <div className=\"comment-icon\">\n                <img\n                  onClick={() => setShowComments(!showComments)}\n                  src=\"./img/icons/message1.svg\"\n                  alt=\"messageicon\"\n                />\n                <span>{post.comments.length}</span>\n              </div>\n              <LikeButton post={post} />\n              <img src=\"./img/icons/share.svg\" alt=\"shareicon\" />\n            </div>\n            {showComments && <CardComments post={post} />}\n          </div>\n        </>\n      )}\n    </li>\n  );\n};\n\nexport default Card;\n"]},"metadata":{},"sourceType":"module"}