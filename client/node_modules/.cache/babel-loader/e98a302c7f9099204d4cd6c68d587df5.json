{"ast":null,"code":"import _slicedToArray from\"/Users/gus/Documents/work_in_progress/gusbook/client/node_modules/@babel/runtime/helpers/esm/slicedToArray\";/* eslint-disable no-unreachable */import React,{useState}from\"react\";import LeftNav from\"../LeftNav\";import{useSelector,useDispatch}from\"react-redux\";import{capitalize,dateParser}from\"../../Util/functions\";import UploadImg from\"./UploadImg\";import{updateBio}from\"../../actions/user.actions\";import FollowHandler from\"./FollowHandler\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";var UpdateProfil=function UpdateProfil(){var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),bio=_useState2[0],setBio=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),updateForm=_useState4[0],setUpdateForm=_useState4[1];var userData=useSelector(function(state){return state.userReducer;});var usersData=useSelector(function(state){return state.usersReducer;});var error=useSelector(function(state){return state.errorReducer.userError;});var dispatch=useDispatch();var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),followingsPopup=_useState6[0],setFollowingsPopup=_useState6[1];var _useState7=useState(false),_useState8=_slicedToArray(_useState7,2),followersPopup=_useState8[0],setFollowersPopup=_useState8[1];var handleUpdate=function handleUpdate(){dispatch(updateBio(userData._id,bio));setUpdateForm(false);};return/*#__PURE__*/_jsxs(\"div\",{className:\"profil-container\",children:[/*#__PURE__*/_jsx(LeftNav,{}),/*#__PURE__*/_jsxs(\"h1\",{children:[\"Profil de \",capitalize(userData.pseudo)]}),/*#__PURE__*/_jsxs(\"div\",{className:\"update-container\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"left-part\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Photo\"}),/*#__PURE__*/_jsx(\"img\",{src:userData.picture,alt:\"profilImage\"}),/*#__PURE__*/_jsx(UploadImg,{}),/*#__PURE__*/_jsx(\"p\",{children:error.maxSize}),/*#__PURE__*/_jsx(\"p\",{children:error.format})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"right-part\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"bio-update\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Bio\"}),updateForm===false&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"p\",{onClick:function onClick(){return setUpdateForm(!updateForm);},children:userData.bio}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return setUpdateForm(!updateForm);},children:\"Modifier Bio\"})]}),updateForm&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(\"textarea\",{type:\"text\",defaultValue:userData.bio,onChange:function onChange(event){return setBio(event.target.value);}}),/*#__PURE__*/_jsx(\"button\",{onClick:function onClick(){return handleUpdate();},children:\"Valider les modifications\"})]})]}),/*#__PURE__*/_jsxs(\"h4\",{children:[\"Membre depuis le \",dateParser(userData.createdAt)]}),/*#__PURE__*/_jsxs(\"h5\",{onClick:function onClick(){return setFollowingsPopup(true);},children:[\"Abonnements :\",\" \",userData.followings?userData.followings.length:\"0\"]}),/*#__PURE__*/_jsxs(\"h5\",{onClick:function onClick(){return setFollowersPopup(true);},children:[\"Abonn\\xE9s : \",userData.followers?userData.followers.length:\"0\"]})]})]}),followingsPopup&&/*#__PURE__*/_jsx(\"div\",{className:\"popup-profil-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Abonnements\"}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setFollowingsPopup(false);},className:\"cross\",children:\"\\u2715\"}),/*#__PURE__*/_jsx(\"ul\",{children:usersData.map(function(user){for(var i=0;i<userData.followings.length;i++){if(user._id===userData.followings[i]){return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"img\",{src:user.picture,alt:\"user-pic\"}),/*#__PURE__*/_jsx(\"h4\",{children:user.pseudo}),/*#__PURE__*/_jsx(\"div\",{className:\"follow-handler\",children:/*#__PURE__*/_jsx(FollowHandler,{type:\"suggestion\",idToFollow:user._id})})]},user._id);}}return null;})})]})}),followersPopup&&/*#__PURE__*/_jsx(\"div\",{className:\"popup-profil-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"modal\",children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Abonn\\xE9s\"}),/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return setFollowersPopup(false);},className:\"cross\",children:\"\\u2715\"}),/*#__PURE__*/_jsx(\"ul\",{children:usersData.map(function(user){for(var i=0;i<userData.followers.length;i++){if(user._id===userData.followers[i]){return/*#__PURE__*/_jsxs(\"li\",{children:[/*#__PURE__*/_jsx(\"img\",{src:user.picture,alt:\"user-pic\"}),/*#__PURE__*/_jsx(\"h4\",{children:user.pseudo}),/*#__PURE__*/_jsx(\"div\",{className:\"follow-handler\",children:/*#__PURE__*/_jsx(FollowHandler,{type:\"suggestion\",idToFollow:user._id})})]},user._id);}}return null;})})]})})]});};export default UpdateProfil;","map":{"version":3,"sources":["/Users/gus/Documents/work_in_progress/gusbook/client/src/components/profil/UpdateProfil.js"],"names":["React","useState","LeftNav","useSelector","useDispatch","capitalize","dateParser","UploadImg","updateBio","FollowHandler","UpdateProfil","bio","setBio","updateForm","setUpdateForm","userData","state","userReducer","usersData","usersReducer","error","errorReducer","userError","dispatch","followingsPopup","setFollowingsPopup","followersPopup","setFollowersPopup","handleUpdate","_id","pseudo","picture","maxSize","format","event","target","value","createdAt","followings","length","followers","map","user","i"],"mappings":"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","sourcesContent":["/* eslint-disable no-unreachable */\nimport React, { useState } from \"react\";\nimport LeftNav from \"../LeftNav\";\nimport { useSelector, useDispatch } from \"react-redux\";\nimport { capitalize, dateParser } from \"../../Util/functions\";\nimport UploadImg from \"./UploadImg\";\nimport { updateBio } from \"../../actions/user.actions\";\nimport FollowHandler from \"./FollowHandler\";\n\nconst UpdateProfil = () => {\n  const [bio, setBio] = useState(\"\");\n  const [updateForm, setUpdateForm] = useState(false);\n  const userData = useSelector((state) => state.userReducer);\n  const usersData = useSelector((state) => state.usersReducer);\n  const error = useSelector((state) => state.errorReducer.userError);\n\n  const dispatch = useDispatch();\n  const [followingsPopup, setFollowingsPopup] = useState(false);\n  const [followersPopup, setFollowersPopup] = useState(false);\n\n  const handleUpdate = () => {\n    dispatch(updateBio(userData._id, bio));\n    setUpdateForm(false);\n  };\n\n  return (\n    <div className=\"profil-container\">\n      <LeftNav />\n      <h1>Profil de {capitalize(userData.pseudo)}</h1>\n      <div className=\"update-container\">\n        <div className=\"left-part\">\n          <h3>Photo</h3>\n          <img src={userData.picture} alt=\"profilImage\" />\n          <UploadImg />\n          <p>{error.maxSize}</p>\n          <p>{error.format}</p>\n        </div>\n        <div className=\"right-part\">\n          <div className=\"bio-update\">\n            <h3>Bio</h3>\n            {updateForm === false && (\n              <>\n                <p onClick={() => setUpdateForm(!updateForm)}>{userData.bio}</p>\n                <button onClick={() => setUpdateForm(!updateForm)}>\n                  Modifier Bio\n                </button>\n              </>\n            )}\n            {updateForm && (\n              <>\n                <textarea\n                  type=\"text\"\n                  defaultValue={userData.bio}\n                  onChange={(event) => setBio(event.target.value)}\n                ></textarea>\n                <button onClick={() => handleUpdate()}>\n                  Valider les modifications\n                </button>\n              </>\n            )}\n          </div>\n          <h4>Membre depuis le {dateParser(userData.createdAt)}</h4>\n          <h5 onClick={() => setFollowingsPopup(true)}>\n            Abonnements :{\" \"}\n            {userData.followings ? userData.followings.length : \"0\"}\n          </h5>\n          <h5 onClick={() => setFollowersPopup(true)}>\n            Abonnés : {userData.followers ? userData.followers.length : \"0\"}\n          </h5>\n        </div>\n      </div>\n      {followingsPopup && (\n        <div className=\"popup-profil-container\">\n          <div className=\"modal\">\n            <h3>Abonnements</h3>\n            <span onClick={() => setFollowingsPopup(false)} className=\"cross\">\n              &#10005;\n            </span>\n            <ul>\n              {usersData.map((user) => {\n                for (let i = 0; i < userData.followings.length; i++) {\n                  if (user._id === userData.followings[i]) {\n                    return (\n                      <li key={user._id}>\n                        <img src={user.picture} alt=\"user-pic\" />\n                        <h4>{user.pseudo}</h4>\n                        <div className=\"follow-handler\">\n                          <FollowHandler\n                            type=\"suggestion\"\n                            idToFollow={user._id}\n                          />\n                        </div>\n                      </li>\n                    );\n                  }\n                }\n                return null;\n              })}\n            </ul>\n          </div>\n        </div>\n      )}\n      {followersPopup && (\n        <div className=\"popup-profil-container\">\n          <div className=\"modal\">\n            <h3>Abonnés</h3>\n            <span onClick={() => setFollowersPopup(false)} className=\"cross\">\n              &#10005;\n            </span>\n            <ul>\n              {usersData.map((user) => {\n                for (let i = 0; i < userData.followers.length; i++) {\n                  if (user._id === userData.followers[i]) {\n                    return (\n                      <li key={user._id}>\n                        <img src={user.picture} alt=\"user-pic\" />\n                        <h4>{user.pseudo}</h4>\n                        <div className=\"follow-handler\">\n                          <FollowHandler\n                            type=\"suggestion\"\n                            idToFollow={user._id}\n                          />\n                        </div>\n                      </li>\n                    );\n                  }\n                }\n                return null;\n              })}\n            </ul>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default UpdateProfil;\n"]},"metadata":{},"sourceType":"module"}